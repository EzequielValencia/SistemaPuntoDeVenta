<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head th:replace="layout/layout :: head">
		 
	</head>
<body ng-app="SistemaPuntoDeVenta" ng-controller="facturasController">
	<link rel="stylesheet"	th:href="@{/css/nuevaFactura.css}" />
	<nav th:replace="layout/layout :: nav"></nav>
	
	<div class="container">
		<h1 class="py-1 display-5 text-center">Nueva factura para {{clienteAsociado.nombre+' '+clienteAsociado.apellidoPaterno+' '+clienteAsociado.apellidoMaterno}}</h1>
		<hr class="bg-danger" />
		<a class="btn btn-primary btn-sm my-3" th:href="@{/clientes/detalleCliente/{{clienteAsociado.id}}}"><i class="fas fa-arrow-circle-left"></i> Volver</a>
		<form>
			<div class="form-group">
					<input style="text-align: right;" class="form-control left" 
					ng-model="codigoProducto" ng-keyup="verificaTeclaPrecionada($event)" 
					placeholder="Ingresa el codigo del producto" autofocus="autofocus"/>
			</div>
			<div class="form-group">
					<button type="button" class="btn btn-success btn-block" ng-click="buscarProducto()">Buscar</button>
			</div>
		</form>
		<form>
			<div class="form-group">
					<input style="text-align: right;" class="form-control left" 
					ng-model="facturaNueva.observacion" placeholder="Concepto"/>
			</div>
		</form>
		
		<div class="container">
			<h3 class="text-right text-danger">Total: {{total | currency:"$"}}</h3>
		</div>
		<div class="containerTable">
		<table class="table table-striped table-bordered table-fixed display">
			<thead class="thead-inverse">
				<tr>
					<th class="text-center">Codigo</th>
					<th class="text-center">Nombre</th>
					<th class="text-center">Cantidad</th>
					<th class="text-center">Costo</th>
					<th class="text-center">Quitar</th>
				</tr>
			</thead>
			<tbody >
				<tr ng-repeat="item in facturaNueva.itemsFactura">
					<td class="text-center">{{item.producto.id}}</td>
					<td class="text-center">{{item.producto.nombre}}</td>
					<td class="text-center">{{item.cantidad}} </td>
					<td class="text-center">{{item.cantidad * item.producto.precioVenta | currency:"$"}}</td>
					<th class="text-center">
						<button type="button" class="btn btn-danger" ng-click="quitarProducto(item.producto.id); reestablacerExistencia(item)">Eliminar <span aria-hidden="true">&times;</span></button>
					</th>
				</tr>
			</tbody>
		</table>
		</div>
		<div class="container">
			<div class="row">
				<button type="button" class="btn btn-success" ng-click="finalizarVenta()">Finalizar venta</button>
				<button type="button" class="btn btn-danger" ng-click="cancelarVenta()">Cancelar venta</button>
			</div>
			<h3 class="text-right text-danger">Total: {{total | currency:"$"}}</h3>
		</div>
	</div>
	
	<footer th:replace="layout/layout :: footer"></footer>
	
	
	<script type="text/javascript" th:src="@{/js/factura/nuevaFactura.js}"></script>
</body>
</html>